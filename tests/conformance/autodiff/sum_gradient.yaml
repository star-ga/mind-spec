# MIND Conformance Test: Sum Gradient
# Specification reference: spec/v1.0/autodiff.md#reduction-gradients
# Category: autodiff
# Profile: cpu

description: "Gradient of full-tensor sum is an all-ones tensor with the same shape as the input"
category: autodiff
profile: cpu

input:
  source: |
    import diff::grad;

    fn sum_fn(x: Tensor<f32, [2, 3]>) -> f32 {
        sum(x, axes=[], keepdims=false)
    }

    fn test_sum_grad() -> Tensor<f32, [2, 3]> {
        let x: Tensor<f32, [2, 3]> = [[1.0, 2.0, 3.0],
                                       [4.0, 5.0, 6.0]];
        grad(sum_fn)(x)
    }

expected:
  status: success
  output:
    result:
      dtype: f32
      shape: [2, 3]
      values: [[1.0, 1.0, 1.0], [1.0, 1.0, 1.0]]
      tolerance: 1e-6
